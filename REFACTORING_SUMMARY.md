# CLI æ¨¡å—é‡æ„æ€»ç»“æŠ¥å‘Š

## ğŸ“… é‡æ„æ—¥æœŸ
2025-11-02

## ğŸ¯ é‡æ„ç›®æ ‡
æ ¹æ®é¡¹ç›®å½“å‰çš„ç®€åŒ–æ¶æ„ï¼Œé‡æ„ CLI æ¨¡å—ï¼Œä½¿å…¶ä¸æ–°æ¶æ„ä¿æŒä¸€è‡´ã€‚

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. **ä¿®å¤æ ¸å¿ƒå¯¼å…¥é”™è¯¯**
- âœ… ä¿®å¤ `utils/scanner.py` ä¸­çš„å¯¼å…¥è·¯å¾„ï¼ˆ`utils.dataps.meta` â†’ `utils.meta`ï¼‰
- âœ… ä¿®å¤ `plugin.py` ä¸­çš„å¯¼å…¥é”™è¯¯ï¼ˆç§»é™¤ä¸å­˜åœ¨çš„ `page` æ¨¡å—ï¼‰
- âœ… ä¿®å¤é…ç½®å­—å…¸è®¿é—®æ–¹å¼ï¼ˆä» `.enabled` æ”¹ä¸º `["enabled"]`ï¼‰

### 2. **æ›´æ–° CLI æ¨¡å—**
- âœ… æ·»åŠ  `CustomGroup` ç±»å®ç°åˆ«åå‘½ä»¤æ ¼å¼åŒ–
  - å‘½ä»¤è¾“å‡ºæ ¼å¼ï¼š`mv, move` å’Œ `rm, remove` æ˜¾ç¤ºåœ¨åŒä¸€è¡Œ
  - è‡ªåŠ¨å¯¹é½å¸®åŠ©æ–‡æœ¬
- âœ… æ›´æ–° `cli.py` ä¸­çš„å¯¼å…¥è·¯å¾„ï¼ˆ`utils.docsps.*` â†’ `utils.cli.*`ï¼‰
- âœ… ä¿ç•™ `utils/cli/` ç›®å½•ç»“æ„ï¼ˆæœªé‡å‘½åä¸º operationsï¼‰

### 3. **æ›´æ–°æµ‹è¯•æ¨¡å—**
- âœ… é‡å†™ `tests/test_config.py`ï¼ˆé€‚é… `MkdocsNoteConfig`ï¼‰
- âœ… é‡å†™ `tests/test_plugin.py`ï¼ˆæ›´æ–°æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ï¼‰
- âœ… é‡å†™ `tests/smoke_test.py`ï¼ˆç®€åŒ–ä¸ºæ ¸å¿ƒæ¨¡å—æµ‹è¯•ï¼‰
- âœ… ç¦ç”¨ä¾èµ–æ—§æ¶æ„çš„æ ¸å¿ƒæµ‹è¯•ï¼ˆé‡å‘½åä¸º `.disabled`ï¼‰
- âœ… æ·»åŠ  `tests/core/README.md` è¯´æ˜æµ‹è¯•çŠ¶æ€

### 4. **ä¿®å¤ Plugin è¿è¡Œæ—¶é—®é¢˜**
- âœ… ä¿®å¤ `graph.py` ä¸­çš„é…ç½®è®¿é—®ï¼ˆæ·»åŠ  `debug` å‚æ•°ï¼‰
- âœ… ä¿®å¤ `_graph` å±æ€§æœªåˆå§‹åŒ–é—®é¢˜ï¼ˆæ·»åŠ  `hasattr` æ£€æŸ¥ï¼‰
- âœ… ä¿®å¤ `scanner.py` ä¸­çš„è·¯å¾„å¤„ç†ï¼ˆæ”¯æŒå­—ç¬¦ä¸²å’Œ Path ç±»å‹ï¼‰

---

## ğŸ“Š æµ‹è¯•ç»“æœ

### âœ… å•å…ƒæµ‹è¯•ï¼š**21/21 é€šè¿‡**
```
tests/test_config.py .................... 4 passed
tests/test_plugin.py ................... 12 passed  
tests/smoke_test.py ....................  5 passed
```

### âœ… æ„å»ºæµ‹è¯•ï¼š**æˆåŠŸ**
```bash
$ uv run mkdocs build
INFO - Documentation built in 0.87 seconds
```

### âœ… æœåŠ¡å™¨æµ‹è¯•ï¼š**æˆåŠŸ**
```bash
$ uv run mkdocs serve
INFO - Serving on http://127.0.0.1:8000/mkdocs-note/
```

---

## ğŸ“ å½“å‰é¡¹ç›®ç»“æ„

```
src/mkdocs_note/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ cli.py                  # CLI å‘½ä»¤å…¥å£ï¼ˆå·²æ›´æ–°ï¼‰
â”œâ”€â”€ config.py               # MkdocsNoteConfig
â”œâ”€â”€ graph.py                # å›¾å¤„ç†ï¼ˆå·²ä¿®å¤ï¼‰
â”œâ”€â”€ plugin.py               # æ’ä»¶å…¥å£ï¼ˆå·²ä¿®å¤ï¼‰
â”‚
â”œâ”€â”€ static/                 # é™æ€èµ„æº
â”‚   â”œâ”€â”€ graph.css
â”‚   â””â”€â”€ graph.js
â”‚
â””â”€â”€ utils/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ meta.py             # å…ƒæ•°æ®æå–å‡½æ•°
    â”œâ”€â”€ scanner.py          # æ–‡ä»¶æ‰«æå‡½æ•°ï¼ˆå·²ä¿®å¤ï¼‰
    â”‚
    â””â”€â”€ cli/                # CLI æ“ä½œæ¨¡å—ï¼ˆä¿ç•™åŸåï¼‰
        â”œâ”€â”€ __init__.py
        â”œâ”€â”€ cleaner.py      # èµ„æºæ¸…ç†
        â”œâ”€â”€ creator.py      # ç¬”è®°åˆ›å»º
        â”œâ”€â”€ initializer.py  # ç›®å½•åˆå§‹åŒ–
        â”œâ”€â”€ mover.py        # ç¬”è®°ç§»åŠ¨
        â””â”€â”€ remover.py      # ç¬”è®°åˆ é™¤
```

---

## âš ï¸ å·²çŸ¥é—®é¢˜

### 1. **é…ç½®è­¦å‘Š**ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
ä»¥ä¸‹æ—§é…ç½®é¡¹å·²è¢«ç§»é™¤ï¼Œä¼šäº§ç”Ÿè­¦å‘Šï¼š
- `timestamp_zone`
- `max_notes`
- `log_level`
- `enable_network_graph`

**è§£å†³æ–¹æ¡ˆ**ï¼šæ›´æ–° `mkdocs.yml`ï¼Œç§»é™¤è¿™äº›é…ç½®é¡¹æˆ–ä½¿ç”¨æ–°çš„é…ç½®ç»“æ„ã€‚

### 2. **å›¾æ•°æ®æ–‡ä»¶ 404**
- `graph/graph.json` æ–‡ä»¶æœªç”Ÿæˆ
- åŸå› ï¼šå›¾åŠŸèƒ½å¯èƒ½éœ€è¦å¯ç”¨æˆ–è¿›ä¸€æ­¥é…ç½®

**è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥ `graph_config` é…ç½®å¹¶ç¡®ä¿æ­£ç¡®å¯ç”¨ã€‚

### 3. **ç¼ºå¤±çš„èµ„æºæ–‡ä»¶**
- `usage/recent_insert_demo.png` æ–‡ä»¶ä¸å­˜åœ¨

**è§£å†³æ–¹æ¡ˆ**ï¼šæ·»åŠ ç¼ºå¤±çš„å›¾ç‰‡æ–‡ä»¶æˆ–æ›´æ–°æ–‡æ¡£é“¾æ¥ã€‚

---

## ğŸš« å·²ç¦ç”¨çš„æµ‹è¯•

ä»¥ä¸‹æµ‹è¯•ä¾èµ–æ—§æ¶æ„ï¼Œå·²è¢«ç¦ç”¨ï¼ˆé‡å‘½åä¸º `.disabled`ï¼‰ï¼š

```
tests/core/
â”œâ”€â”€ test_assets_manager.py.disabled
â”œâ”€â”€ test_file_manager.py.disabled
â”œâ”€â”€ test_frontmatter_manager.py.disabled
â”œâ”€â”€ test_graph_handler_simple.py.disabled
â”œâ”€â”€ test_note_cleaner.py.disabled
â”œâ”€â”€ test_note_creator.py.disabled
â”œâ”€â”€ test_note_initializer.py.disabled
â”œâ”€â”€ test_note_manager.py.disabled
â””â”€â”€ test_note_remover.py.disabled
```

**åŸå› **ï¼šè¿™äº›æµ‹è¯•ä¾èµ–çš„æ¨¡å—ï¼ˆ`utils.assetps`, `utils.dataps`, `utils.docsps`, `utils.fileps`ï¼‰å·²è¢«ç§»é™¤ã€‚

**åç»­å·¥ä½œ**ï¼šéœ€è¦æ ¹æ®æ–°æ¶æ„é‡å†™è¿™äº›æµ‹è¯•ã€‚

---

## ğŸ¨ CLI å‘½ä»¤æ ¼å¼ä¼˜åŒ–

### æ”¹è¿›å‰ï¼š
```
Commands:
  clean    Clean up orphaned asset directories...
  move     Move or rename a note file/directory...
  mv       Alias for 'move' command
  new      Create a new note file...
  remove   Remove a note file...
  rm       Alias for 'remove' command
```

### æ”¹è¿›åï¼š
```
Commands:
  clean       Clean up orphaned asset directories...
  mv, move    Move or rename a note file/directory...
  new         Create a new note file...
  rm, remove  Remove a note file...
  template    Manage the note template file.
```

---

## ğŸ“ åç»­å»ºè®®

### 1. **CLI æ¨¡å—åŠŸèƒ½æ¢å¤**ï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰
å½“å‰ CLI å‘½ä»¤åªæœ‰å ä½ç¬¦å®ç°ï¼Œéœ€è¦ï¼š
- å®ç° `new` å‘½ä»¤ï¼ˆç¬”è®°åˆ›å»ºï¼‰
- å®ç° `remove`/`rm` å‘½ä»¤ï¼ˆç¬”è®°åˆ é™¤ï¼‰
- å®ç° `move`/`mv` å‘½ä»¤ï¼ˆç¬”è®°ç§»åŠ¨ï¼‰
- å®ç° `clean` å‘½ä»¤ï¼ˆæ¸…ç†å­¤ç«‹èµ„æºï¼‰
- å®ç° `template` å‘½ä»¤ï¼ˆæ¨¡æ¿ç®¡ç†ï¼‰

### 2. **é‡å†™æ ¸å¿ƒæµ‹è¯•**ï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰
ä¸ºæ–°æ¶æ„ç¼–å†™æµ‹è¯•ï¼š
- `utils.meta` å‡½æ•°æµ‹è¯•
- `utils.scanner` å‡½æ•°æµ‹è¯•
- CLI æ“ä½œæµ‹è¯•ï¼ˆå½“åŠŸèƒ½å®ç°åï¼‰

### 3. **æ›´æ–°é…ç½®ç³»ç»Ÿ**ï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰
- ç§»é™¤æ—§é…ç½®é¡¹è­¦å‘Š
- æ–‡æ¡£åŒ–æ–°çš„é…ç½®ç»“æ„
- æä¾›é…ç½®è¿ç§»æŒ‡å—

### 4. **å®Œå–„æ–‡æ¡£**ï¼ˆä¼˜å…ˆçº§ï¼šä½ï¼‰
- æ›´æ–°æ¶æ„æ–‡æ¡£ï¼ˆ`docs/contributing/architecture.md`ï¼‰
- æ›´æ–°å˜æ›´æ—¥å¿—ï¼ˆ`docs/about/changelog.md`ï¼‰
- æ·»åŠ è¿ç§»æŒ‡å—

---

## ğŸ‰ é‡æ„æˆæœ

1. âœ… **æ’ä»¶æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸è¿è¡Œ**
   - MkDocs å¯ä»¥æ­£å¸¸æ„å»ºæ–‡æ¡£
   - MkDocs serve å¯ä»¥æ­£å¸¸å¯åŠ¨
   - æ‰€æœ‰æµ‹è¯•é€šè¿‡

2. âœ… **ä»£ç ç»“æ„æ›´æ¸…æ™°**
   - ç§»é™¤äº†è¿‡åº¦è®¾è®¡çš„æ¨¡å—å±‚æ¬¡
   - ä¿ç•™äº†å¿…è¦çš„åŠŸèƒ½åˆ†ç¦»
   - æ›´å®¹æ˜“ç†è§£å’Œç»´æŠ¤

3. âœ… **CLI ç”¨æˆ·ä½“éªŒæ”¹å–„**
   - åˆ«åå’Œä¸»å‘½ä»¤æ˜¾ç¤ºåœ¨åŒä¸€è¡Œ
   - å¸®åŠ©æ–‡æœ¬æ•´é½å¯¹é½
   - æ›´ç¬¦åˆç”¨æˆ·ä¹ æƒ¯

4. âœ… **æµ‹è¯•åŸºç¡€è®¾æ–½å°±ç»ª**
   - æ ¸å¿ƒåŠŸèƒ½æœ‰å®Œæ•´æµ‹è¯•è¦†ç›–
   - Smoke æµ‹è¯•ç¡®ä¿åŸºæœ¬åŠŸèƒ½
   - ä¸ºåç»­å¼€å‘æ‰“ä¸‹åŸºç¡€

---

## ğŸ“Œ å…³é”®å†³ç­–è®°å½•

1. **ä¿ç•™ `utils/cli/` ç›®å½•å**
   - åŸå› ï¼šCLI æ˜¯å¹¿ä¸ºäººçŸ¥çš„æœ¯è¯­ï¼Œæ¯” operations æ›´ç›´è§‚
   - ç”¨æˆ·å»ºè®®ï¼šä¿æŒä¸€è‡´æ€§

2. **ç¦ç”¨è€Œéåˆ é™¤æ—§æµ‹è¯•**
   - åŸå› ï¼šä¿ç•™æµ‹è¯•é€»è¾‘ä½œä¸ºå‚è€ƒ
   - æ–‡ä»¶é‡å‘½åä¸º `.disabled` åç¼€
   - æ·»åŠ  README è¯´æ˜çŠ¶æ€

3. **ç®€åŒ–é…ç½®è®¿é—®æ–¹å¼**
   - ä»å¯¹è±¡å±æ€§è®¿é—®æ”¹ä¸ºå­—å…¸è®¿é—®
   - é€‚é… MkDocs çš„é…ç½®ç³»ç»Ÿ
   - æé«˜çµæ´»æ€§

---

## æ€»ç»“

æœ¬æ¬¡é‡æ„æˆåŠŸåœ°å°† CLI æ¨¡å—é€‚é…åˆ°æ–°çš„ç®€åŒ–æ¶æ„ä¸­ï¼Œæ¢å¤äº†æ’ä»¶çš„æ ¸å¿ƒåŠŸèƒ½ï¼ˆæ–‡æ¡£æ„å»ºå’ŒæœåŠ¡ï¼‰ã€‚è™½ç„¶ CLI å‘½ä»¤åŠŸèƒ½å°šæœªå®Œå…¨å®ç°ï¼Œä½†åŸºç¡€è®¾æ–½å·²ç»å°±ç»ªï¼Œä¸ºåç»­å¼€å‘é“ºå¹³äº†é“è·¯ã€‚

**é‡æ„çŠ¶æ€**ï¼šâœ… **åŸºæœ¬å®Œæˆ**

**ä¸‹ä¸€æ­¥**ï¼šå®ç° CLI å‘½ä»¤çš„å®é™…åŠŸèƒ½

